

哨兵节点用于监控Redis集群的节点，当Master节点宕机后，自动进行Redis节点选主

哨兵节点定时ping Redis集群的节点，当接收不到响应的时候，则认为Redis节点宕机

假设我们有三个Redis节点，分别是：

192.168.3.100（主）

192.168.3.101（从）

192.168.3.102（从）

当主节点宕机后，我们执行如下操作：

```shell
# 1. 随机选取一个从节点，设置为主节点，当然了，这儿是有完善的选主策略
192.168.3.102:6379 > slaveof no one
# 2. 查看节点是否已经设置为主节点
192.168.3.102:6379 > info
...
role:master

# 3. 修改其他从节点附属于主节点
192.168.3.101:6379 > slaveof 192.168.3.102 6379
# 4. 设置挂掉的节点为从节点
192.168.3.100:6379 > slaveof 192.168.3.102 6379

# 其他
# 直接在主节点就可以获取到集群中所有节点的信息
192.168.3.102:6379 > info
...
role:master
...
slave0:ip=192.168.3.101,port=6379,state=online ...
slave0:ip=192.168.3.102,port=6379,state=online ...
....

```

Redis节点选主策略：优先选择健康状态的、距离上次回复时间短的、数据量和主节点相近的

只有一个哨兵节点的话，会存在哨兵节点宕机后，无法监控Redis集群，因此可以创建3个哨兵节点组成哨兵集群，避免单个哨兵节点单点故障

对于哨兵集群，需要有一半以上的哨兵节点反馈主节点宕机，才能真正认为主节点宕机，后续才进行Redis选主

那究竟让哪个哨兵节点来进行Redis选主呢？我们需要在哨兵集群中选择一个领头者，选择Raft算法来选择领头者